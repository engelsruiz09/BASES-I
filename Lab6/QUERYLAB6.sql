CREATE TABLE PARTIDO
(
ID_PARTIDO INT NOT NULL,
NOMBRE VARCHAR(50) NOT NULL,
CANDIDATOS INT NOT NULL

CONSTRAINT PK_PARTIDOS PRIMARY KEY(ID_PARTIDO)
)
INSERT PARTIDO
(ID_PARTIDO, NOMBRE, CANDIDATOS)
VALUES
(1, 'SSP', 2)
INSERT PARTIDO
(ID_PARTIDO, NOMBRE, CANDIDATOS)
VALUES
(2, 'CSD', 5)
INSERT PARTIDO
(ID_PARTIDO, NOMBRE, CANDIDATOS)
VALUES
(3, 'NSP', 10)
INSERT PARTIDO
(ID_PARTIDO, NOMBRE, CANDIDATOS)
VALUES
(4, 'BDF', 9)
INSERT PARTIDO
(ID_PARTIDO, NOMBRE, CANDIDATOS)
VALUES
(5, 'SAG', 6)

CREATE TABLE VOTO
(
ID_VOTO INT NOT NULL,
ID_PARTIDO INT NOT NULL,
ID_SEDE INT NOT NULL,
MUNICIPIO VARCHAR(50) NOT NULL,
DEPARTAMENTO VARCHAR(50) NOT NULL,
HORA TIME NOT NULL,
FECHA DATE NOT NULL

CONSTRAINT PK_VOTO PRIMARY KEY(ID_VOTO),
CONSTRAINT FK_VOTO_PARTIDO FOREIGN KEY (ID_PARTIDO) REFERENCES PARTIDO(ID_PARTIDO),
CONSTRAINT FK_VOTO_SEDE FOREIGN KEY (ID_SEDE) REFERENCES SEDE(ID_SEDE)
)
INSERT VOTO
(ID_VOTO, ID_PARTIDO, MUNICIPIO, DEPARTAMENTO, FECHA, HORA, ID_SEDE)
VALUES
(1, 1, 'QUETZALTENANGO', 'TAPACHULA', '2022-02-25', '09:19:00', 1)
INSERT VOTO
(ID_VOTO, ID_PARTIDO, MUNICIPIO, DEPARTAMENTO, FECHA, HORA, ID_SEDE)
VALUES
(2, 1, 'QUETZALTENANGO', 'COATEPEQUE', '2022/02/22', '10:00',5)
INSERT VOTO
(ID_VOTO, ID_PARTIDO, MUNICIPIO, DEPARTAMENTO, FECHA, HORA, ID_SEDE)
VALUES
(3, 5, 'PETEN', 'BELMOPAN', '2022/02/25', '21:24',4)
INSERT VOTO
(ID_VOTO, ID_PARTIDO, MUNICIPIO, DEPARTAMENTO, FECHA, HORA, ID_SEDE)
VALUES
(4, 2, 'GUATEMALA', 'MIXCO', '2022/05/22', '17:02',2)
INSERT VOTO
(ID_VOTO, ID_PARTIDO, MUNICIPIO, DEPARTAMENTO, FECHA, HORA, ID_SEDE)
VALUES
(5, 1, 'QUETZALTENANGO', 'COATEPEQUE', '2022/02/22', '10:00', 5)
INSERT VOTO
(ID_VOTO, ID_PARTIDO, MUNICIPIO, DEPARTAMENTO, FECHA, HORA, ID_SEDE)
VALUES
(6, 4, 'QUETZALTENANGO', 'COATEPEQUE', '2022/02/22', '10:00', 5)
INSERT VOTO
(ID_VOTO, ID_PARTIDO, MUNICIPIO, DEPARTAMENTO, FECHA, HORA, ID_SEDE)
VALUES
(7, 2, 'QUETZALTENANGO', 'COATEPEQUE', '2022/02/22', '10:00', 5)

CREATE TABLE SEDE
(
ID_SEDE INT NOT NULL,
MUNICIPIO VARCHAR(50) NOT NULL,
DEPARTAMENTO VARCHAR(50) NOT NULL,
NOMBRE VARCHAR(50) NOT NULL,
DIRECCION VARCHAR(50)

CONSTRAINT PK_SEDE PRIMARY KEY(ID_SEDE)
)
INSERT SEDE
(ID_SEDE, MUNICIPIO, DEPARTAMENTO, NOMBRE, DIRECCION)
VALUES
(1, 'COBAN', 'ALTA VERAPAZ', 'SEDE CENTRAL ALTA VERAPAZ', '')
INSERT SEDE
(ID_SEDE, MUNICIPIO, DEPARTAMENTO, NOMBRE, DIRECCION)
VALUES
(2, 'SALAMA', 'BAJA VERAPAZ', 'SEDE CENTRAL BAJA VERAPAZ', '')
INSERT SEDE
(ID_SEDE, MUNICIPIO, DEPARTAMENTO, NOMBRE, DIRECCION)
VALUES
(3, 'RABINAL','BAJA VERAPAZ', 'SEDE RURAL BAJA VERAPAZ', '')
INSERT SEDE
(ID_SEDE, MUNICIPIO, DEPARTAMENTO, NOMBRE, DIRECCION)
VALUES
(4, 'EL TEJAR', 'CHIMALTENANGO', 'SEDE CENTRAL CHIMALTENANGO', '')
INSERT SEDE
(ID_SEDE, MUNICIPIO, DEPARTAMENTO, NOMBRE, DIRECCION)
VALUES
(5, 'CHIQUIMULA', 'CHIQUIMULA', 'SEDE CENTRAL CHIQUIMULA', '')

CREATE TABLE SUPERVISOR
(
ID_SUPERVISOR INT NOT NULL,
ID_PARTIDO INT NOT NULL,
NOMBRE VARCHAR(50) NOT NULL

CONSTRAINT PK_SUPERVISOR PRIMARY KEY(ID_SUPERVISOR),
CONSTRAINT FK_SUPERVISOR_PARTIDO FOREIGN KEY (ID_PARTIDO) REFERENCES PARTIDO(ID_PARTIDO)
)

CREATE TABLE ESTRUCTURA_MESA
(
ID_ESTRUCTURA INT NOT NULL,
ID_SUPERVISOR INT NOT NULL,
ID_SEDE INT NOT NULL,
PRESIDENTE VARCHAR(50) NOT NULL,
VOCAL1 VARCHAR(50) NOT NULL,
VOCAL2 VARCHAR(50) NOT NULL,
VOCALS1 VARCHAR(50) NOT NULL,
VOCALS2 VARCHAR(50) NOT NULL

CONSTRAINT PK_ESTRUCTURA PRIMARY KEY(ID_ESTRUCTURA),
CONSTRAINT FK_SUPERVISOR_ESTRUCTURA FOREIGN KEY (ID_SUPERVISOR) REFERENCES SUPERVISOR(ID_SUPERVISOR),
CONSTRAINT FK_ESTRUCTURA_SEDE FOREIGN KEY (ID_SEDE) REFERENCES SEDE(ID_SEDE)
)

SELECT ID_PARTIDO ,COUNT(1) AS TOTAL
FROM VOTO
GROUP BY ID_PARTIDO
ORDER BY ID_PARTIDO ASC

SELECT ID_SEDE, COUNT(ID_SEDE) AS PARTICIPACION_PORCENTAJE, HORA
FROM VOTO
WHERE (HORA >= '8:00:00' AND HORA <= '20:00:00')
GROUP BY HORA, ID_SEDE

SELECT MUNICIPIO, COUNT(1) AS PARTICIPACION_PORCENTAJE, HORA
FROM VOTO
WHERE (HORA >= '8:00:00' AND HORA <= '20:00:00')
GROUP BY HORA, MUNICIPIO

SELECT DEPARTAMENTO, COUNT(1) AS PARTICIPACION_PORCENTAJE, HORA
FROM VOTO
WHERE (HORA >= '8:00:00' AND HORA <= '20:00:00')
GROUP BY HORA, DEPARTAMENTO